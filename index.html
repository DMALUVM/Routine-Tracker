<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Routine Tracker 2026 â€“ Dave</title>

<style>
  :root {
    --primary: #0066ff;
    --success: #00c853;
    --warning: #ffab00;
    --danger: #d50000;
    --bg: #f5f9ff;
    --card: white;
    --text: #1a1a2e;
    --muted: #546e7a;
    --shadow-sm: 0 2px 10px rgba(0,0,0,0.08);
    --shadow-md: 0 8px 32px rgba(0,0,0,0.14);
    --transition: all 0.38s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  * { box-sizing: border-box; margin:0; padding:0; }

  body {
    font-family: system-ui, -apple-system, BlinkMacOSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: linear-gradient(135deg, #f0f4ff 0%, #e3f2fd 100%);
    color: var(--text);
    min-height: 100vh;
    padding: 24px 16px;
    line-height: 1.5;
  }

  h1 {
    text-align: center;
    color: var(--primary);
    font-weight: 800;
    letter-spacing: -0.5px;
    margin-bottom: 1.6em;
  }

  #summary {
    background: var(--card);
    border-radius: 16px;
    padding: 24px;
    margin: 0 auto 40px;
    max-width: 1100px;
    box-shadow: var(--shadow-md);
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(190px, 1fr));
    gap: 16px;
    margin: 24px 0;
  }

  .stat-card {
    background: rgba(0,102,255,0.04);
    border: 1px solid rgba(0,102,255,0.12);
    border-radius: 12px;
    padding: 16px;
    text-align: center;
    transition: var(--transition);
  }

  .stat-card:hover {
    transform: translateY(-4px);
    box-shadow: var(--shadow-md);
  }

  .stat-number {
    font-size: 2.8rem;
    font-weight: 800;
    color: var(--success);
    line-height: 1;
  }

  #calendar {
    max-width: 1200px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 28px;
  }

  .month {
    background: var(--card);
    border-radius: 16px;
    padding: 20px;
    box-shadow: var(--shadow-md);
  }

  .month h3 {
    text-align: center;
    margin-bottom: 16px;
    color: var(--primary);
    font-weight: 700;
  }

  .weekdays {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    font-weight: 600;
    color: var(--muted);
    text-align: center;
    margin-bottom: 8px;
  }

  .days-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 6px;
  }

  .day-cell {
    aspect-ratio: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    font-weight: 600;
    cursor: pointer;
    transition: var(--transition);
    position: relative;
    font-size: 1.05rem;
  }

  .day-cell:hover:not(.future) {
    transform: scale(1.14);
    box-shadow: 0 0 0 3px rgba(0,102,255,0.22);
  }

  .day-cell.today {
    border: 3px solid var(--primary);
    transform: scale(1.08);
  }

  .day-cell.complete    { background: var(--success); color: white; }
  .day-cell.partial     { background: var(--warning); color: black; }
  .day-cell.missed      { background: var(--danger);  color: white; }
  .day-cell.future      { background: #f0f0f0; color: #aaa; cursor: default; }

  .day-emoji {
    position: absolute;
    bottom: 4px;
    right: 4px;
    font-size: 1.2rem;
    filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5));
  }

  /* Modal â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ */
  #modal {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.58);
    backdrop-filter: blur(8px);
    display: none;
    place-items: center;
    z-index: 2000;
    opacity: 0;
    transition: opacity 0.5s ease;
  }

  #modal.show { opacity: 1; }

  #modal-content {
    background: var(--card);
    border-radius: 20px;
    width: 92%;
    max-width: 620px;
    max-height: 90vh;
    overflow-y: auto;
    padding: 28px;
    box-shadow: 0 24px 80px rgba(0,0,0,0.32);
    transform: scale(0.84) translateY(60px);
    opacity: 0;
    transition: all 0.62s cubic-bezier(0.34,1.56,0.64,1);
  }

  #modal.show #modal-content {
    transform: none;
    opacity: 1;
  }

  .modal-title {
    margin: 0 0 24px;
    color: var(--primary);
    font-size: 1.8rem;
    font-weight: 700;
  }

  .section {
    margin-bottom: 32px;
  }

  .section h3 {
    margin: 0 0 14px;
    font-size: 1.25rem;
    color: var(--primary);
    border-bottom: 1px solid rgba(0,102,255,0.18);
    padding-bottom: 8px;
  }

  .routine-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
    gap: 12px;
  }

  .routine-item {
    display: flex;
    align-items: center;
    padding: 14px 16px;
    background: rgba(0,0,0,0.025);
    border-radius: 12px;
    transition: var(--transition);
    cursor: pointer;
  }

  .routine-item:hover {
    background: rgba(0,102,255,0.07);
    transform: translateX(5px);
  }

  .routine-item.completed {
    background: rgba(0,200,83,0.14);
  }

  input[type="checkbox"] {
    transform: scale(1.45);
    margin-right: 14px;
    accent-color: var(--success);
  }

  .emoji-big {
    font-size: 1.9rem;
    margin-right: 14px;
    min-width: 38px;
    text-align: center;
  }

  .note {
    font-size: 0.82rem;
    color: var(--muted);
    margin-left: 10px;
  }

  .modal-buttons {
    display: flex;
    justify-content: flex-end;
    gap: 16px;
    margin-top: 28px;
    padding-top: 20px;
    border-top: 1px solid rgba(0,0,0,0.1);
  }

  button {
    padding: 12px 28px;
    border: none;
    border-radius: 12px;
    font-weight: 600;
    font-size: 1rem;
    cursor: pointer;
    transition: var(--transition);
  }

  #save-btn {
    background: var(--primary);
    color: white;
  }

  #save-btn:hover {
    background: #0055dd;
    transform: translateY(-2px);
  }

  #close-btn {
    background: #78909c;
    color: white;
  }

  #close-btn:hover {
    background: #607d8b;
  }

  @media (max-width: 640px) {
    body { padding: 16px 12px; }
    .routine-grid { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>

<h1>Routine Tracker 2026</h1>

<div id="summary">
  <h2>Current Streaks & Progress</h2>
  <div class="stats-grid" id="streaks-container"></div>

  <h3>This Week</h3>
  <div class="stats-grid" id="weekly-container"></div>
</div>

<div id="calendar"></div>

<!-- Modal -->
<div id="modal" role="dialog" aria-modal="true">
  <div id="modal-content">
    <h2 class="modal-title" id="modal-title">Edit Day</h2>

    <div id="routines-list"></div>

    <div class="modal-buttons">
      <button id="close-btn">Cancel</button>
      <button id="save-btn">Save Changes</button>
    </div>
  </div>
</div>

<script>
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CONFIGURATION
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const YEAR = 2026;
const STORAGE_KEY = `routines-${YEAR}`;

const ROUTINES = {
  daily: [
    { name: "Lymphatic morning movement", emoji: "ğŸƒâ€â™‚ï¸" },
    { name: "Weight training",             emoji: "ğŸ‹ï¸â€â™‚ï¸" },
    { name: "Nattokinase in the morning",  emoji: "ğŸ’Š" },
    { name: "Magnesium in the evening",    emoji: "ğŸŒ™" },
    { name: "Breathwork/meditation",       emoji: "ğŸ§˜â€â™‚ï¸" },
    { name: "Creatine",                    emoji: "ğŸ¥¤" },
    { name: "Collagen",                    emoji: "ğŸ§´" },
    { name: "Reading before bed",          emoji: "ğŸ“–" }
  ],
  neurofeedback: {
    name: "Neurofeedback",
    emoji: "ğŸ§ ",
    weeklyGoal: 5
  },
  mwf: [
    { name: "Test & HCG", emoji: "ğŸ’‰", note: "Mon/Wed/Fri only" }
  ],
  variable: [
    { name: "Sauna", emoji: "ğŸ§–â€â™‚ï¸" }
  ]
};

let data = JSON.parse(localStorage.getItem(STORAGE_KEY)) || {};

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// DATE HELPERS
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function pad(n) { return String(n).padStart(2, '0'); }

function formatDate(m, d) {
  return `${YEAR}-${pad(m)}-${pad(d)}`;
}

function isPastOrToday(str) {
  const [y,m,d] = str.split('-').map(Number);
  return new Date(y, m-1, d) <= new Date(new Date().setHours(0,0,0,0));
}

function isToday(str) {
  return str === new Date().toISOString().slice(0,10);
}

function getDayOfWeek(str) {
  return new Date(str).getDay(); // 0=Sun ... 6=Sat
}

function getWeekNumber(str) {
  const d = new Date(str);
  d.setHours(0,0,0,0);
  d.setDate(d.getDate() + 3 - (d.getDay() || 7));
  const yearStart = new Date(d.getFullYear(), 0, 1);
  return Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// STREAK & WEEKLY LOGIC
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function calculateStreaks() {
  const todayKey = new Date().toISOString().slice(0,10);
  const names = [
    ...ROUTINES.daily.map(r => r.name),
    ROUTINES.neurofeedback.name,
    ...ROUTINES.mwf.map(r => r.name),
    ...ROUTINES.variable.map(r => r.name)
  ];

  const streaks = Object.fromEntries(names.map(n => [n, 0]));

  let date = new Date();
  date.setHours(0,0,0,0);

  while (date.getFullYear() === YEAR) {
    const key = date.toISOString().slice(0,10);
    const entry = data[key] || {};

    let allDoneToday = true;

    names.forEach(name => {
      if (entry[name]) {
        streaks[name]++;
      } else {
        streaks[name] = 0;
        allDoneToday = false;
      }
    });

    if (!allDoneToday && Object.keys(entry).length === 0) break;

    date.setDate(date.getDate() - 1);
  }

  return streaks;
}

function getThisWeekNeuroCount() {
  const thisWeek = getWeekNumber(new Date().toISOString().slice(0,10));
  let count = 0;
  Object.keys(data).forEach(k => {
    if (getWeekNumber(k) === thisWeek && data[k][ROUTINES.neurofeedback.name]) {
      count++;
    }
  });
  return count;
}

function renderSummary() {
  const streaks = calculateStreaks();
  const container = document.getElementById('streaks-container');
  container.innerHTML = '';

  Object.entries(streaks).forEach(([name, count]) => {
    const card = document.createElement('div');
    card.className = 'stat-card';
    card.innerHTML = `
      <h4 style="margin-bottom:6px;">${name}</h4>
      <div class="stat-number">${count}</div>
      <div style="font-size:0.9rem;color:var(--muted);">day streak</div>
    `;
    container.appendChild(card);
  });

  // Weekly neuro
  const neuroCount = getThisWeekNeuroCount();
  const weekly = document.getElementById('weekly-container');
  weekly.innerHTML = `
    <div class="stat-card">
      <h4 style="margin-bottom:6px;">Neurofeedback</h4>
      <div class="stat-number">${neuroCount} / ${ROUTINES.neurofeedback.weeklyGoal}</div>
      <div style="font-size:0.9rem;color:var(--muted);">this week</div>
    </div>
  `;
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// CALENDAR RENDERING
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderCalendar() {
  const container = document.getElementById('calendar');
  container.innerHTML = '';

  for (let m = 1; m <= 12; m++) {
    const monthDiv = document.createElement('div');
    monthDiv.className = 'month';

    const title = document.createElement('h3');
    title.textContent = new Date(YEAR, m-1, 1).toLocaleString('default', { month: 'long' }) + ` ${YEAR}`;
    monthDiv.appendChild(title);

    const weekdays = document.createElement('div');
    weekdays.className = 'weekdays';
    'Sun Mon Tue Wed Thu Fri Sat'.split(' ').forEach(d => {
      const span = document.createElement('span');
      span.textContent = d;
      weekdays.appendChild(span);
    });
    monthDiv.appendChild(weekdays);

    const grid = document.createElement('div');
    grid.className = 'days-grid';

    const firstDay = new Date(YEAR, m-1, 1).getDay();
    for (let i = 0; i < firstDay; i++) {
      grid.appendChild(document.createElement('div'));
    }

    const daysInMonth = new Date(YEAR, m, 0).getDate();

    for (let d = 1; d <= daysInMonth; d++) {
      const dateKey = formatDate(m, d);
      const cell = document.createElement('div');
      cell.className = 'day-cell';
      cell.textContent = d;

      if (isToday(dateKey)) cell.classList.add('today');

      if (isPastOrToday(dateKey)) {
        const entry = data[dateKey] || {};
        const dow = getDayOfWeek(dateKey);

        const total =
          ROUTINES.daily.length +
          1 + // neurofeedback
          ([1,3,5].includes(dow) ? ROUTINES.mwf.length : 0) +
          (entry['Sauna'] ? 1 : 0);

        const completed = Object.keys(entry).length;

        if (completed === total) {
          cell.classList.add('complete');
          cell.innerHTML += '<span class="day-emoji">âœ…</span>';
        } else if (completed > 0) {
          cell.classList.add('partial');
          cell.innerHTML += '<span class="day-emoji">â³</span>';
        } else {
          cell.classList.add('missed');
          cell.innerHTML += '<span class="day-emoji">âŒ</span>';
        }

        cell.onclick = () => openModal(dateKey, entry);
      }

      grid.appendChild(cell);
    }

    monthDiv.appendChild(grid);
    container.appendChild(monthDiv);
  }

  renderSummary();
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// MODAL
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function openModal(dateKey, entry = {}) {
  document.getElementById('modal-title').textContent = `Edit routines â€” ${dateKey}`;

  const container = document.getElementById('routines-list');
  container.innerHTML = '';

  // Daily
  addSection(container, 'Daily Routines', ROUTINES.daily, entry);

  // Neurofeedback
  addSection(container, 'Weekly Goal (5Ã—/week)', [ROUTINES.neurofeedback], entry);

  // M/W/F conditional
  const dow = new Date(dateKey).getDay();
  if ([1,3,5].includes(dow)) {
    addSection(container, 'M/W/F Only', ROUTINES.mwf, entry);
  }

  // Variable
  addSection(container, 'Variable / Optional', ROUTINES.variable, entry);

  const modal = document.getElementById('modal');
  modal.style.display = 'grid';
  requestAnimationFrame(() => modal.classList.add('show'));
  modal.dataset.date = dateKey;
}

function addSection(parent, title, items, entryData) {
  const section = document.createElement('div');
  section.className = 'section';
  section.innerHTML = `<h3>${title}</h3>`;

  const grid = document.createElement('div');
  grid.className = 'routine-grid';

  items.forEach(item => {
    const checked = !!entryData[item.name];
    const row = document.createElement('div');
    row.className = `routine-item${checked ? ' completed' : ''}`;
    row.innerHTML = `
      <input type="checkbox" ${checked ? 'checked' : ''} data-name="${item.name}">
      <span class="emoji-big">${item.emoji}</span>
      <span class="routine-label">${item.name}</span>
      ${item.note ? `<span class="note">(${item.note})</span>` : ''}
    `;

    row.onclick = e => {
      if (e.target.tagName !== 'INPUT') {
        row.querySelector('input').click();
      }
    };

    row.querySelector('input').onchange = function() {
      row.classList.toggle('completed', this.checked);
    };

    grid.appendChild(row);
  });

  section.appendChild(grid);
  parent.appendChild(section);
}

document.getElementById('save-btn').onclick = () => {
  const date = document.getElementById('modal').dataset.date;
  const newEntry = {};

  document.querySelectorAll('#routines-list input:checked').forEach(cb => {
    newEntry[cb.dataset.name] = true;
  });

  if (Object.keys(newEntry).length > 0) {
    data[date] = newEntry;
  } else {
    delete data[date];
  }

  localStorage.setItem(STORAGE_KEY, JSON.stringify(data));
  closeModal();
  renderCalendar();
};

document.getElementById('close-btn').onclick = closeModal;

function closeModal() {
  const modal = document.getElementById('modal');
  modal.classList.remove('show');
  setTimeout(() => { modal.style.display = 'none'; }, 620);
}

// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// INITIALIZE
// â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
renderCalendar();
</script>
</body>
</html>
